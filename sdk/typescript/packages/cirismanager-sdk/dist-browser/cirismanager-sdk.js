!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("axios")):"function"==typeof define&&define.amd?define(["axios"],e):"object"==typeof exports?exports.CIRISManagerSDK=e(require("axios")):t.CIRISManagerSDK=e(t.axios)}(this,t=>(()=>{"use strict";var e={140:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TelemetryAPI=void 0,e.TelemetryAPI=class{constructor(t){this.axios=t}async health(){return(await this.axios.get("/telemetry/health")).data}async getStatus(){return(await this.axios.get("/telemetry/status")).data}async getHistory(t={}){return(await this.axios.get("/telemetry/history",{params:{hours:t.hours||24,interval:t.interval||"5m"}})).data}async getPublicStatus(){return(await this.axios.get("/telemetry/public/status")).data}async getPublicHistory(t=24){return(await this.axios.get("/telemetry/public/history",{params:{hours:t}})).data}async getAgentMetrics(t,e=24){return(await this.axios.get(`/telemetry/agent/${t}`,{params:{hours:e}})).data}async getContainerMetrics(t,e=24){return(await this.axios.get(`/telemetry/container/${t}`,{params:{hours:e}})).data}async collect(){return(await this.axios.post("/telemetry/collect")).data}streamMetrics(t,e=5e3){let a=null;return(async()=>{try{const e=await this.getStatus();t(e)}catch(t){console.error("Failed to fetch initial telemetry:",t)}a=setInterval(async()=>{try{const e=await this.getStatus();t(e)}catch(t){console.error("Failed to fetch telemetry:",t)}},e)})(),()=>{a&&clearInterval(a)}}}},155:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DeploymentsAPI=void 0,e.DeploymentsAPI=class{constructor(t){this.axios=t}async getStatus(){try{return(await this.axios.get("/updates/status")).data}catch(t){if(404===t.response?.status)return null;throw t}}async getPending(){return(await this.axios.get("/updates/pending")).data}async launch(t,e=!1){return(await this.axios.post("/updates/launch",{deployment_id:t,force:e})).data}async reject(t,e){return(await this.axios.post("/updates/reject",{deployment_id:t,reason:e})).data}async pause(){return(await this.axios.post("/updates/pause")).data}async rollback(t){return(await this.axios.post("/updates/rollback",t)).data}async getHistory(t=10){return(await this.axios.get("/updates/history",{params:{limit:t}})).data}async getRollbackOptions(){return(await this.axios.get("/updates/rollback-options")).data}async getCurrentImages(){return(await this.axios.get("/updates/current-images")).data}watchDeployment(t,e){let a=null;return(async()=>{try{const a=await this.getStatus();if(a&&a.deployment_id===t&&(e(a),"completed"===a.status||"failed"===a.status||"cancelled"===a.status))return}catch(t){console.error("Failed to fetch initial deployment status:",t)}a=setInterval(async()=>{try{const r=await this.getStatus();r&&r.deployment_id===t&&(e(r),"completed"!==r.status&&"failed"!==r.status&&"cancelled"!==r.status||a&&clearInterval(a))}catch(t){console.error("Failed to poll deployment status:",t)}},2e3)})(),()=>{a&&clearInterval(a)}}async notify(t){return(await this.axios.post("/updates/notify",t)).data}}},156:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a);var s=Object.getOwnPropertyDescriptor(e,a);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[a]}}),Object.defineProperty(t,r,s)}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__exportStar||function(t,e){for(var a in t)"default"===a||Object.prototype.hasOwnProperty.call(e,a)||r(e,t,a)};Object.defineProperty(e,"__esModule",{value:!0}),e.TelemetryAPI=e.DeploymentsAPI=e.AgentsAPI=e.CIRISManagerClient=void 0;var o=a(985);Object.defineProperty(e,"CIRISManagerClient",{enumerable:!0,get:function(){return o.CIRISManagerClient}});var n=a(665);Object.defineProperty(e,"AgentsAPI",{enumerable:!0,get:function(){return n.AgentsAPI}});var i=a(155);Object.defineProperty(e,"DeploymentsAPI",{enumerable:!0,get:function(){return i.DeploymentsAPI}});var c=a(140);Object.defineProperty(e,"TelemetryAPI",{enumerable:!0,get:function(){return c.TelemetryAPI}}),s(a(613),e),s(a(725),e)},613:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},665:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AgentsAPI=void 0,e.AgentsAPI=class{constructor(t){this.axios=t}async list(){return(await this.axios.get("/agents")).data}async get(t){return(await this.axios.get(`/agents/${t}`)).data}async create(t){return(await this.axios.post("/agents",t)).data}async delete(t){await this.axios.delete(`/agents/${t}`)}async start(t){return(await this.axios.post(`/agents/${t}/start`)).data}async stop(t){return(await this.axios.post(`/agents/${t}/stop`)).data}async restart(t){return(await this.axios.post(`/agents/${t}/restart`)).data}async shutdown(t,e=!1){return(await this.axios.post(`/agents/${t}/shutdown`,{force:e})).data}async getConfig(t){return(await this.axios.get(`/agents/${t}/config`)).data}async updateConfig(t,e){return(await this.axios.patch(`/agents/${t}/config`,e)).data}async getVersions(){return(await this.axios.get("/agents/versions")).data}watchStatus(t,e){return()=>{}}}},725:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RateLimitError=e.ValidationError=e.ConflictError=e.NotFoundError=e.AuthenticationError=e.NetworkError=e.CIRISError=void 0;class a extends Error{constructor(t,e,a){super(t),this.statusCode=e,this.code=a,this.name="CIRISError"}}e.CIRISError=a,e.NetworkError=class extends a{constructor(t){super(t),this.name="NetworkError"}},e.AuthenticationError=class extends a{constructor(t){super(t,401,"AUTHENTICATION_FAILED"),this.name="AuthenticationError"}},e.NotFoundError=class extends a{constructor(t){super(`${t} not found`,404,"NOT_FOUND"),this.name="NotFoundError"}},e.ConflictError=class extends a{constructor(t){super(t,409,"CONFLICT"),this.name="ConflictError"}},e.ValidationError=class extends a{constructor(t,e){super(t,400,"VALIDATION_ERROR"),this.errors=e,this.name="ValidationError"}},e.RateLimitError=class extends a{constructor(t){super("Rate limit exceeded",429,"RATE_LIMITED"),this.name="RateLimitError"}}},742:e=>{e.exports=t},985:function(t,e,a){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.CIRISManagerClient=void 0;const s=r(a(742)),o=a(665),n=a(155),i=a(140),c=a(725);e.CIRISManagerClient=class{constructor(t={}){const e=t.baseURL||"/manager/v1";this.axios=s.default.create({baseURL:e,timeout:t.timeout||3e4,headers:{"Content-Type":"application/json",...t.token?{Authorization:`Bearer ${t.token}`}:{}}}),this.axios.interceptors.response.use(t=>t,async e=>{if(401===e.response?.status)throw t.onAuthFailure?.(),new c.AuthenticationError("Authentication failed");if("ECONNABORTED"===e.code||!e.response)throw new c.NetworkError("Network request failed");throw new c.CIRISError(e.response?.data?.detail||e.message,e.response?.status)}),t.retries&&this.setupRetry(t.retries),this.agents=new o.AgentsAPI(this.axios),this.deployments=new n.DeploymentsAPI(this.axios),this.telemetry=new i.TelemetryAPI(this.axios)}setupRetry(t){this.axios.interceptors.response.use(void 0,async e=>{const a=e.config;if(a&&a.retry||(a.retry={count:0}),a.retry.count++,a.retry.count>t)return Promise.reject(e);const r=Math.min(1e3*Math.pow(2,a.retry.count),1e4);return await new Promise(t=>setTimeout(t,r)),this.axios(a)})}setToken(t){this.axios.defaults.headers.common.Authorization=`Bearer ${t}`}async health(){return(await this.axios.get("/health")).data}async status(){return(await this.axios.get("/status")).data}}}},a={};return function t(r){var s=a[r];if(void 0!==s)return s.exports;var o=a[r]={exports:{}};return e[r].call(o.exports,o,o.exports,t),o.exports}(156)})());
